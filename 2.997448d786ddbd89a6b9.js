(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{392:function(e,t,n){"use strict";n.r(t);var r,a,c,i,o=n(0),s=n(749),l=n(176),u=n(59),m=n(10),p=n.n(m),d=n(12),f=n.n(d),E=n(13),g=n.n(E),v=n(14),b=n.n(v),y=n(9),h=n.n(y),w=n(15),x=n.n(w),k=n(3),j=n.n(k),A=n(17),O=n.n(A),S=n(20),q=n(113),C=n(35),T=n(724),I=n(726),M=n(725),R=n(723),F=n(722),N=Object(S.c)(function(e){var t=e.exams,n=e.renderActions;return o.createElement(T.a,null,o.createElement(M.a,null,o.createElement(R.a,null,o.createElement(F.a,null,"ID"),o.createElement(F.a,null,"Название"),o.createElement(F.a,null,"Описание"),o.createElement(F.a,null,"Обучение"),o.createElement(F.a,null,"Действия"))),o.createElement(I.a,null,t.map(function(e){return o.createElement(R.a,{key:e.id},o.createElement(F.a,null,e.id),o.createElement(F.a,null,e.name),o.createElement(F.a,null,e.description),o.createElement(F.a,null,e.training?e.training.name:"Не требуется"),o.createElement(F.a,null,n(e)))})))}),B=n(705),H=n(731),P=n(732),U=n(737),D=n(30),L=Object(D.c)(O()(function(e){return{container:{marginBottom:e.spacing(2),marginLeft:e.spacing(.5),marginRight:e.spacing(.5)}}}),S.c)(function(e){var t=e.exams,n=e.renderActions,r=e.classes;return o.createElement(B.a,{container:!0},t.map(function(e){return o.createElement(B.a,{item:!0,key:e.id,xs:12,sm:6,md:4,lg:3},o.createElement(H.a,{className:r.container},o.createElement(U.a,{titleTypographyProps:{variant:"subtitle1"},title:e.name}),o.createElement(P.a,null,o.createElement(u.a,null,e.description)),n(e)))}))}),z=n(1),W=n(38),_=n(764),J=Object(W.ub)(W.R).named("Questions").actions(function(e){return{parseErrors:function(t){var n=Object(z.getEnv)(e).api.parseErrors(t,{default:"Ошибка загрузки вопросов"});return Object(z.getEnv)(e).snackBar.show(n.form,{variant:"error"}),n},mapResponse:function(t){e.items=t.questions},invokeRequest:function(){return Object(z.getEnv)(e).api.exams.getExam(Object(z.getParent)(e).id)}}}),Q=W.A.named("ExamItem").props({questions:z.types.optional(J,{}),training:z.types.maybeNull(_.b)}),G=Object(W.ub)(Q).actions(function(e){return{invokeRequest:function(){return Object(z.getEnv)(e).api.exams.getExams()}}}),K=Object(W.ub)(W.R).named("Questions").actions(function(e){return{parseErrors:function(t){var n=Object(z.getEnv)(e).api.parseErrors(t,{default:"Ошибка загрузки вопросов"});return Object(z.getEnv)(e).snackBar.show(n.form,{variant:"error"}),n},mapResponse:function(t){e.items=t.questions},invokeRequest:function(t){return Object(z.getEnv)(e).api.exams.getExam(t)}}}),V=W.B.named("ExamForm").props({data:z.types.optional(z.types.model("Answers",{examId:z.types.maybeNull(z.types.number),categoryId:z.types.maybeNull(z.types.number),productId:z.types.maybeNull(z.types.number),answers:z.types.array(z.types.reference(W.a))}),{}),questions:z.types.optional(K,{})}).views(function(e){return{get answersCount(){return e.data.answers.length}}}).actions(function(e){return{addAnswer:function(t){e.data.answers.push(t)},removeAnswer:function(t){e.data.answers=e.data.answers.filter(function(e){return t!==e})},parseErrors:function(t){var n=Object(z.getEnv)(e).api.parseErrors(t,{default:"Произошла ошибка при проверке теста",406:"Вы неверно ответили на некоторые вопросы"});return Object(z.getEnv)(e).snackBar.show(n.form,{variant:"error",duration:5e3,vertical:"top",horizontal:"center"}),n},invokeRequest:function(t){var n={answers:t.answers.map(function(e){return{answerId:e.id,questionId:e.questionId}}),categoryId:e.data.categoryId,productId:e.data.productId};return Object(z.getEnv)(e).api.exams.checkExam(t.examId,n)},afterRequest:function(t){var n=t.correctAnswers,r=t.answersCount,a=t.notAllAnswers;if(t.success)Object(z.getEnv)(e).snackBar.show("Поздравляем, Вы прошли тест! Ваш результат ".concat(n," из ").concat(r),{variant:"success",duration:5e3,vertical:"top",horizontal:"center"});else{if(a)return void Object(z.getEnv)(e).snackBar.show("Увы, тест не пройден",{variant:"error",duration:5e3,vertical:"top",horizontal:"center"});Object(z.getEnv)(e).snackBar.show("Увы, тест не пройден :( Ваш результат ".concat(n," из ").concat(r," Попробуйте еще раз"),{variant:"error",duration:5e3,vertical:"top",horizontal:"center"})}},removeAnswers:function(t){e.data.answers=e.data.answers.filter(function(e){return!t.includes(e)})}}}),X=n(767),Y=n(652),Z=n(220),$=n(24),ee=n.n($),te=n(52),ne=n.n(te),re=n(326),ae=n.n(re),ce=n(325),ie=n.n(ce),oe=n(704),se=n(679),le=n.n(se),ue=O()(function(e){return{icon:{marginLeft:e.spacing(2)}}})(Object(S.c)(function(e){var t=e.answer,n=e.onSelect,r=e.selected,a=e.classes;return o.createElement(o.Fragment,null,o.createElement(l.a,{variant:"contained",color:"primary",fullWidth:!0,onClick:function(){return n(t)}},t.text,r&&o.createElement(le.a,{className:a.icon})))})),me=n(647),pe=n(733),de=n(746),fe=Object(S.c)(function(e){var t=e.answer,n=e.onSelect,r=e.onUnselect,a=e.selected;return o.createElement(me.a,{fullWidth:!0},o.createElement(pe.a,{label:t.text,control:o.createElement(de.a,{color:"primary",checked:a,onChange:function(){return a?r(t):n(t)}})}))}),Ee=O()(function(){return{image:{width:"100%",height:200,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"}}})(r=Object(S.c)(r=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=g()(this,(e=b()(t)).call.apply(e,[this].concat(a))),j()(h()(n),"onSelect",function(e){var t=n.props,r=t.question,a=t.addAnswer,c=t.removeAnswers,i=t.nextStep;r.multiple||(c(n.getSelectedAnswers()),i()),a(e)}),j()(h()(n),"onUnselect",function(e){n.props.removeAnswer(e)}),j()(h()(n),"getSelectedAnswers",function(){var e=n.props,t=e.question;return e.selectedAnswers.filter(function(e){return e.questionId===t.id})}),n}return x()(t,e),f()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.question,r=t.selectedAnswers,a=t.classes,c=n.multiple?fe:ue;return o.createElement(o.Fragment,null,o.createElement(u.a,{color:"textPrimary"},n.description),n.multiple&&o.createElement("div",null,o.createElement(u.a,{variant:"caption"},"Выберите несколько ответов")),n.imageUrl&&o.createElement(q.q,{images:[n.imageUrl]},function(e){var t=e.show;return o.createElement("div",{className:a.image,onClick:t,style:{backgroundImage:"url(".concat(n.imageUrl,")")}})}),o.createElement(oe.a,null),n.answers.map(function(t){return o.createElement(c,{key:t.id,selected:r.includes(t),answer:t,onSelect:e.onSelect,onUnselect:e.onUnselect})}))}}]),t}(o.Component))||r)||r,ge=O()(function(){return{controls:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}})(a=Object(S.c)(a=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=g()(this,(e=b()(t)).call.apply(e,[this].concat(a))),j()(h()(n),"state",{step:0}),j()(h()(n),"onSubmit",ne()(ee.a.mark(function e(){var t;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.form.request();case 2:t=e.sent,n.props.onChecked(t&&t.success);case 4:case"end":return e.stop()}},e)}))),j()(h()(n),"nextStep",function(){n.state.step<n.props.form.questions.items.length-1&&n.setState(function(e){return{step:e.step+1}})}),j()(h()(n),"prevStep",function(){n.state.step>0&&n.setState(function(e){return{step:e.step-1}})}),n}return x()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.form.questions.getItems(this.props.exam.id),this.props.form.change("examId",this.props.exam.id)}},{key:"render",value:function(){var e=this.props,t=e.form,n=e.classes,r=t.addAnswer,a=t.removeAnswer,c=t.removeAnswers,i=t.questions,s=t.data,m=t.answersCount,p=this.state.step,d=i.items.length,f=d>0&&i.items[p];return o.createElement(o.Fragment,null,o.createElement(u.a,{variant:"caption"},"Отвечено: ",m,"/",d),o.createElement("div",{className:n.controls},o.createElement("div",null,o.createElement(Z.a,{color:"primary",onClick:this.prevStep,disabled:p<1},o.createElement(ie.a,null)),o.createElement(Z.a,{color:"primary",onClick:this.nextStep,disabled:p===d-1},o.createElement(ae.a,null))),o.createElement(l.a,{size:"small",variant:"outlined",color:"primary",onClick:this.onSubmit},"Отправить")),f&&o.createElement(Ee,{question:f,selectedAnswers:s.answers,addAnswer:r,removeAnswer:a,removeAnswers:c,nextStep:this.nextStep}))}}]),t}(o.Component))||a)||a,ve=Object(C.c)(V,{name:"form"})(c=Object(S.c)(c=function(e){function t(){return p()(this,t),g()(this,b()(t).apply(this,arguments))}return x()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.exam,n=e.form,r=e.onSuccess;return o.createElement(q.i,{title:t.name,loading:n.sending||n.questions.loading,content:function(e){var a=e.onClose;return o.createElement(Y.a,null,o.createElement(ge,{onChecked:function(e){e&&r(),a()},form:n,exam:t}))}},function(e){var t=e.show;return o.createElement(l.a,{onClick:t,color:"primary"},"Пройти")})}}]),t}(o.Component))||c)||c,be=O()(function(e){return{cardActionText:{padding:e.spacing(2)}}})(i=Object(C.c)(G,{name:"exams"})(i=Object(S.b)("store")(i=Object(S.c)(i=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=g()(this,(e=b()(t)).call.apply(e,[this].concat(a))),j()(h()(n),"onSuccess",function(){n.getExams(),n.props.store.app.getCurrentUser()}),j()(h()(n),"getExams",function(){n.props.exams.getItems()}),j()(h()(n),"renderActions",function(e){var t=n.props.classes,r=e.training;if(e.userExam)return o.createElement(u.a,{className:t.cardActionText,color:"textSecondary"},"Вы прошли экзамен");if(r){if(!r.userTraining)return r.typeHMS?o.createElement(l.a,{ariant:"text",color:"primary",onClick:function(e){e.stopPropagation(),r.accept()},href:r.description,target:"_blank"},"Открыть обучение"):o.createElement(X.a,{training:r,onAccept:n.getExams,title:"Запись на обучение",subTitle:r.name,openLabel:"Записаться на обучение",content:o.createElement(u.a,null,"Вы действительно хотите записаться на обучение ",r.name,"?")});if(r.userTraining.statusFailed)return o.createElement(u.a,{className:t.cardActionText,color:"textSecondary"},"Вы не прошли обучение");if(r.userTraining.statusWaiting)return r.typeHMS?o.createElement(X.b,{training:r,onConfirm:n.getExams,subTitle:r.name,content:o.createElement(u.a,null,"Вы действительно прошли обучение ",r.name,"?")}):o.createElement(u.a,{className:t.cardActionText,color:"textSecondary"},"Вы записаны на обучение")}return o.createElement(ve,{exam:e,onSuccess:n.onSuccess})}),n}return x()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getExams()}},{key:"render",value:function(){var e=this.props.exams,t=e.items,n=e.loading,r={exams:t,renderActions:this.renderActions};return o.createElement(q.s,{noWrap:!0,loading:n},o.createElement(q.k,{variant:"absolute",visible:t.length<1&&!n},o.createElement(s.a,{smDown:!0},o.createElement(N,r)),o.createElement(s.a,{mdUp:!0},o.createElement(L,r))))}}]),t}(o.Component))||i)||i)||i)||i;t.default=function(){return o.createElement(be,null)}},764:function(e,t,n){"use strict";var r=n(1),a=n(38),c=a.L.named("TrainingAcceptForm").props({id:r.types.maybeNull(r.types.number)}).actions(function(e){var t=e.afterRequest;return{reset:function(){e.setData({id:e.id}),e.sending=!1},invokeRequest:function(){return Object(r.getEnv)(e).api.trainings.acceptTraining(e.id)},parseErrors:function(t){var n=Object(r.getEnv)(e).api.parseErrors(t,{409.1:"Вы работаете в этот день",409.2:"Вы уже записались на это обучение",404:"Тест не найден",default:"Не удалось записаться на обучение"});return Object(r.getEnv)(e).snackBar.show(n.form,{variant:"error"}),n},afterRequest:function(n){Object(r.getParent)(e).typeHMS||Object(r.getEnv)(e).snackBar.show("Вы подтвердили желание принять участие в обучении.",{variant:"success"}),t(n)}}}),i=a.L.named("TrainingConfirmForm").props({id:r.types.maybeNull(r.types.number)}).actions(function(e){var t=e.afterRequest;return{reset:function(){e.setData({id:e.id}),e.sending=!1},afterRequest:function(n){!e.typeHMS&&Object(r.getEnv)(e).snackBar.show("Вы подтвердили прохождение обучения.",{variant:"success"}),t(n)},invokeRequest:function(){return Object(r.getEnv)(e).api.trainings.confirmTraining(e.id)},parseErrors:function(t){var n=Object(r.getEnv)(e).api.parseErrors(t,{default:"Не удалось подтвердить обучение"});return Object(r.getEnv)(e).snackBar.show(n.form,{variant:"error"}),n}}}),o=Object(a.rb)({ItemModel:a.db}).props({confirmForm:r.types.optional(i,{}),acceptForm:r.types.optional(c,{})}).actions(function(e){var t=e.afterItemUpdate;return{afterItemUpdate:function(n){t(n),e.confirmForm.setData(n),e.acceptForm.setData(n)},accept:function(){var t;return(t=e.acceptForm).request.apply(t,arguments)},confirm:function(){var t;return(t=e.confirmForm).request.apply(t,arguments)}}}),s=n(3),l=n.n(s),u=n(32),m=n.n(u)()({},a.qb,l()({},a.t,o)),p=Object(a.xb)({eventEntityModelByType:m}),d=a.z.props({entity:r.types.union({dispatcher:p})}).named("MainEvent");n.d(t,"b",function(){return o}),n.d(t,"a",function(){return d})},767:function(e,t,n){"use strict";var r,a=n(749),c=n(10),i=n.n(c),o=n(12),s=n.n(o),l=n(13),u=n.n(l),m=n(14),p=n.n(m),d=n(9),f=n.n(d),E=n(15),g=n.n(E),v=n(3),b=n.n(v),y=n(0),h=n(20),w=n(113),x=n(35),k=n(724),j=n(726),A=n(725),O=n(723),S=n(722),q=n(59),C=n(176),T=n(18),I=n.n(T),M=n(24),R=n.n(M),F=n(52),N=n.n(F),B=n(21),H=n.n(B),P=Object(h.c)(function(e){var t=e.training,n=t.acceptForm.sending,r=t.accept,a=e.onAccept,c=void 0===a?function(){}:a,i=e.children,o=H()(e,["training","onAccept","children"]);return y.createElement(w.f,I()({title:"Принять участие",dialogProps:{loading:n},onConfirm:N()(R.a.mark(function e(){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:if(!e.sent){e.next=6;break}return c(),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}},e)})),content:y.createElement(q.a,null,"Вы действительно хотите посетить это обучение?")},o),i&&i)}),U=Object(h.c)(function(e){var t=e.training,n=t.confirmForm.sending,r=t.confirm,a=e.onConfirm,c=void 0===a?function(){}:a,i=e.children,o=H()(e,["training","onConfirm","children"]);return y.createElement(w.f,I()({title:"Завершить обучение",openLabel:"Прошел обучение",dialogProps:{loading:n},onConfirm:N()(R.a.mark(function e(){return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:if(!e.sent){e.next=6;break}return c(),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}},e)})),content:y.createElement(q.a,null,"Вы действительно прошли это обучение?")},o),i&&i)}),D=Object(h.c)(function(e){var t=e.training;return y.createElement(O.a,null,y.createElement(S.a,null,t.id),y.createElement(S.a,null,t.name),y.createElement(S.a,null,t.typeHMS?y.createElement(C.a,{variant:"text",color:"primary",onClick:t.accept,href:t.description,target:"_blank"},"Открыть обучение"):t.description),y.createElement(S.a,null,!t.typeHMS&&t.dateAsText),y.createElement(S.a,null,!t.typeHMS&&t.address),y.createElement(S.a,null,t.userTraining&&t.userTraining.statusPassed?y.createElement(q.a,{color:"textSecondary"},"Обучение пройдено"):t.typeHMS?y.createElement(U,{training:t,openLabel:"Завершить обучение",content:y.createElement(q.a,null,'Вы действительно прошли обучение "',t.name,'"?')}):t.userTraining&&t.userTraining.statusWaiting?y.createElement(q.a,{color:"textSecondary"},"Вы записаны на обучение"):y.createElement(P,{training:t,title:"Подтверждение",openLabel:"Принять участие",content:y.createElement(q.a,null,'Вы действительно хотите посетить обучение "',t.name,'"?')})))}),L=function(e){var t=e.trainings,n=e.onAccept;return y.createElement(k.a,null,y.createElement(A.a,null,y.createElement(O.a,null,y.createElement(S.a,null,"id"),y.createElement(S.a,null,"Название"),y.createElement(S.a,null,"Описание"),y.createElement(S.a,null,"Дата"),y.createElement(S.a,null,"Адрес"),y.createElement(S.a,null,"Статус"))),y.createElement(j.a,null,t.map(function(e){return y.createElement(D,{key:e.id,training:e,onAccept:n})})))},z=n(705),W=n(731),_=n(735),J=n(732),Q=n(17),G=n.n(Q),K=n(30),V=Object(K.c)(G()(function(e){return{container:{marginBottom:e.spacing(2),marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},subtitle:{whiteSpace:"nowrap"}}}),h.c)(function(e){var t=e.training,n=e.classes;return y.createElement(W.a,{className:n.container},y.createElement(_.a,null,y.createElement(J.a,null,y.createElement(q.a,{variant:"h6",color:"textPrimary"},t.name),y.createElement(q.a,{variant:"body1",color:"textSecondary",className:n.subtitle},!t.typeHMS&&t.description),y.createElement(q.a,null,!t.typeHMS&&"Дата: ".concat(t.dateAsText)),y.createElement(q.a,null,!t.typeHMS&&"Адрес: ".concat(t.address)),y.createElement(z.a,{container:!0},y.createElement(z.a,{item:!0},t.typeHMS&&y.createElement(C.a,{variant:"contained",color:"primary",onClick:function(e){t.accept(),e.stopPropagation()},href:t.description,target:"_blank"},"Открыть обучение")),y.createElement(z.a,{item:!0},t.userTraining&&t.userTraining.statusPassed?y.createElement(q.a,{color:"textSecondary"},y.createElement("span",null,"Обучение пройдено")):t.typeHMS?y.createElement(U,{training:t,openLabel:"Завершить обучение",content:y.createElement(q.a,null,'Вы действительно прошли обучение "'.concat(t.name,'"?'))}):t.userTraining&&t.userTraining.statusWaiting?y.createElement(q.a,{color:"textSecondary"},"Вы записаны на обучение"):y.createElement(P,{training:t,openLabel:"Принять участие",content:y.createElement(q.a,null,'Вы действительно хотите посетить обучение "'.concat(t.name,'"?'))}))))))}),X=function(e){var t=e.trainings,n=e.onAccept;return y.createElement(z.a,{container:!0},t.map(function(e){return y.createElement(z.a,{item:!0,key:e.id,xs:12,lg:4,md:6,sm:12},y.createElement(V,{training:e,onAccept:n}))}))},Y=n(1),Z=n(38),$=n(764),ee=Object(Z.ub)($.b).named("Trainings").actions(function(e){return{invokeRequest:function(){return Object(Y.getEnv)(e).api.trainings.getTrainings()}}}),te=Object(x.c)(ee,{name:"trainings"})(r=Object(h.c)(r=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return n=u()(this,(e=p()(t)).call.apply(e,[this].concat(a))),b()(f()(n),"onAccept",function(){n.props.trainings.getItems()}),n}return g()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.trainings.getItems()}},{key:"render",value:function(){var e=this.props.trainings,t=e.items,n=e.loading,r={trainings:t,onAccept:this.onAccept};return y.createElement(w.s,{noWrap:!0,variant:"fixed",loading:n},y.createElement(w.k,{variant:"absolute",visible:t.length<1&&!n},y.createElement(a.a,{smDown:!0},y.createElement(L,r)),y.createElement(a.a,{mdUp:!0},y.createElement(X,r))))}}]),t}(y.Component))||r)||r;n.d(t,"c",function(){return te}),n.d(t,"a",function(){return P}),n.d(t,"b",function(){return U})}}]);