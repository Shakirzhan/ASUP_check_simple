(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{399:function(e,t,n){"use strict";n.r(t);var a,r=n(10),c=n.n(r),o=n(12),s=n.n(o),i=n(13),l=n.n(i),u=n(14),m=n.n(u),p=n(15),d=n.n(p),y=n(0),f=n(152),h=n(705),v=n(59),g=n(18),E=n.n(g),b=n(17),k=n.n(b),C=n(3),w=n.n(C),x=n(20),I=n(36),N=n.n(I),O=n(35),S=n(113),j=n(24),D=n.n(j),T=n(66),R=n.n(T),A=n(1),B=n(38),M=A.types.model("SummaryItem",{daysCount:A.types.number,hoursCount:A.types.number}),F=A.types.model("Summary",{current:M,previous:M}),V=A.types.model("CalendarDay",{date:A.types.number,status:A.types.number,holiday:A.types.maybeNull(B.F),vacancy:A.types.maybeNull(B.kb),training:A.types.maybeNull(B.db),loading:A.types.optional(A.types.boolean,!1),error:A.types.optional(A.types.boolean,!1)}).views(function(e){return{get isHoliday(){return!!e.holiday},get isTraining(){return!!e.training},get isWork(){return!!e.vacancy},get hasVacancies(){return e.status===B.hb}}}),q=Object(B.ub)(V).named("SchedulerCalendar").props({date:A.types.maybeNull(A.types.number),summary:A.types.maybeNull(F),monthOffset:0}).actions(function(e){return{changeMonthOffset:function(t){e.monthOffset=t,e.getItems()},invokeRequest:function(){return Object(A.getEnv)(e).api.vacancies.getDays(e.monthOffset)},afterRequest:Object(A.flow)(D.a.mark(function t(n){var a,r,c,o,s,i;return D.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.days,r=n.date,t.next=3,Object(A.getEnv)(e).api.schedules.getSchedules(e.monthOffset);case 3:c=t.sent,o=c.current,s=c.previous,i=c.vacancies,e.date=r,e.items=[].concat(R()(a),R()(i.map(function(e){return V.create({date:e.date,vacancy:e,status:B.gb})}))),e.summary={current:o,previous:s};case 10:case"end":return t.stop()}},t)})),mapResponse:function(){}}}).views(function(e){return{getDayByDate:function(t){return e.items.find(function(e){return e.date===t})}}}),z=n(771),W=Object(x.c)(function(e){var t=e.date,n=e.day,a=e.updateCalendar;return y.createElement(S.j,{onClose:a,subTitle:t.format("DD, MMMM"),title:"Список вакансий",body:function(e){var n=e.close;return y.createElement(z.b,{date:t.unix(),onRespondSuccess:n})}},function(e){var a=e.show;return y.createElement(S.z.VacanciesDay,{onClick:a,date:t,day:n})})}),_=n(653),P=n(176),L=n(652),U=function(e){var t=e.onClose,n=e.vacancy;return y.createElement(y.Fragment,null,y.createElement(L.a,null,y.createElement("form",{onSubmit:function(e){e.preventDefault(),t()}},y.createElement(v.a,{variant:"caption"},"Роль"),y.createElement(v.a,{variant:"body1"},n.role.name),y.createElement(v.a,{variant:"caption"},"Магазин"),y.createElement(v.a,{variant:"body1"},n.shop.address),n.spot&&y.createElement(y.Fragment,null,y.createElement(v.a,{variant:"caption"},"Пост"),y.createElement(v.a,{variant:"body1"},n.spot.name)),y.createElement(v.a,{variant:"caption"},"Планируемое время работы"),y.createElement(v.a,{variant:"body1"},n.plan.asText))),y.createElement(_.a,null,y.createElement(P.a,{variant:"contained",color:"primary",onClick:t,form:"workFormId"},"Ок")))},Y=function(e){var t=e.date,n=e.day;return y.createElement(S.i,{content:function(e){return y.createElement(U,E()({},e,{vacancy:n.vacancy}))},title:"Рабочий день",subTitle:t.format("dddd, DD MMMM")},function(e){var a=e.show;return y.createElement(S.z.WorkDay,{onClick:a,date:t,day:n})})},J=Object(O.c)(q,{name:"calendar"})(a=k()(function(e){return{helpContainer:{marginBottom:90},helpItem:{padding:e.spacing(1)},helpBox:{width:e.spacing(2.5),height:e.spacing(2.5),marginRight:e.spacing(1),border:"1px solid gray"},work:{backgroundColor:"rgba(233,190,149, 0.5)"},vacancies:{backgroundColor:"rgba(11,243,131, 0.5)"},holiday:{backgroundColor:"rgba(255,221,0, 0.5)"},training:{backgroundColor:"rgba(131,170,236, 0.5)"},summaryContainer:w()({position:"fixed",bottom:0,padding:e.spacing(1),backgroundColor:e.palette.secondary.main,color:"white",width:"100%"},e.breakpoints.up("md"),{width:"calc(100% - ".concat(e.drawer.width,"px)")})}})(a=Object(x.c)(a=function(e){function t(){return c()(this,t),l()(this,m()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.calendar.getItems()}},{key:"render",value:function(){var e=this.props,t=e.calendar,n=e.classes,a=t.loading,r=t.error,c=t.getItems,o=t.summary;return y.createElement(S.s,{loading:a},y.createElement(S.m,{visible:r,message:"Не удалось загрузить календарь",onRetry:c},y.createElement(S.z,E()({model:t},{VacanciesDayComponent:W,WorkDayComponent:Y})),y.createElement(h.a,{container:!0,className:n.helpContainer},y.createElement(h.a,{item:!0,className:n.helpItem},y.createElement(h.a,{container:!0,alignItems:"center"},y.createElement("div",{className:N()(n.helpBox,n.work)}),y.createElement(v.a,null,"- рабочий день"))),y.createElement(h.a,{item:!0,className:n.helpItem},y.createElement(h.a,{container:!0,alignItems:"center"},y.createElement("div",{className:N()(n.helpBox,n.holiday)}),y.createElement(v.a,null,"- выходной"))),y.createElement(h.a,{item:!0,className:n.helpItem},y.createElement(h.a,{container:!0,alignItems:"center"},y.createElement("div",{className:N()(n.helpBox,n.training)}),y.createElement(v.a,null,"- обучение"))),y.createElement(h.a,{item:!0,className:n.helpItem},y.createElement(h.a,{container:!0,alignItems:"center"},y.createElement("div",{className:N()(n.helpBox,n.vacancies)}),y.createElement(v.a,null,"- свободные вакансии")))),o&&y.createElement(f.a,{square:!0,className:n.summaryContainer},y.createElement(v.a,{color:"inherit",variant:"h6"},"Информация о месяце"),y.createElement(h.a,{container:!0,direction:"column"},y.createElement(h.a,{item:!0},y.createElement(v.a,{color:"inherit"},"Отработано в текущем месяце: ".concat(o.current.daysCount," дн."))),y.createElement(h.a,{item:!0},y.createElement(v.a,{color:"inherit"},"Отработано в прошлом месяце: ".concat(o.previous.daysCount," дн."))),y.createElement(h.a,{item:!0})))))}}]),t}(y.Component))||a)||a)||a,H=function(e){function t(){return c()(this,t),l()(this,m()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return y.createElement(J,null)}}]),t}(y.Component);t.default=H},766:function(e,t,n){"use strict";var a=n(1),r=n(38),c=r.B.named("RespondForm").props({data:a.types.optional(a.types.model({vacancyId:a.types.maybeNull(a.types.number)}),{})}).actions(function(e){return{invokeRequest:function(t){return Object(a.getEnv)(e).api.vacancies.respond(t.vacancyId)},reset:function(){e.sending=!1},parseErrors:function(t){var n=Object(a.getEnv)(e).api.parseErrors(t,o);return Object(a.getEnv)(e).snackBar.show(n.form,{variant:"error"}),n},afterRequest:function(){Object(a.getEnv)(e).snackBar.show("Вы успешно откликнулись на вакансию",{variant:"success"})}}}),o={default:"Не удалось откликнуться на вакансию",404:"Вакансия не найдена",406.1:"Вакансия уже неактуальна",406.2:"У вас недостаточно компетенции для этой вакансии",409.1:"Вы уже работаете в этот день",409.2:"У вас обучение в этот день",409.3:"У вас выходной в этот день",423:"Вакансия зарезервирована для работников ВПРОКа"},s=r.kb.named("VacancyItem").props({respondForm:a.types.optional(c,function(){return c.create()})}).actions(function(e){return{afterCreate:function(){e.respondForm.change("vacancyId",e.id)}}}),i=Object(r.ub)(s).named("VacanciesList").props({date:a.types.maybeNull(a.types.number),shopId:a.types.maybeNull(a.types.number)}).actions(function(e){return{invokeRequest:function(){return Object(a.getEnv)(e).api.vacancies.getVacanciesByShop(e.shopId,e.date)},setDate:function(t){e.date=t},setShopId:function(t){e.shopId=t,e.getItems()},setDateAndShopId:function(t,n){e.setDate(t),e.setShopId(n)}}}),l=Object(r.ub)(r.Z).named("ShopsList").props({date:a.types.maybeNull(a.types.number)}).actions(function(e){return{invokeRequest:function(){return Object(a.getEnv)(e).api.vacancies.getShops(e.date,{})},setDate:function(t){e.date=t}}}),u=n(24),m=n.n(u),p=a.types.model({loading:!1,errors:a.types.maybeNull(a.types.frozen()),vacancy:a.types.maybeNull(r.kb)}).views(function(e){return{get titleText(){if(!e.vacancy)return"На сегодня у вас работы нет";switch(e.vacancy.status){case r.kb.VACANCY_STATUS_PROCESS:return"Наступило время вашей работы.";case r.kb.VACANCY_STATUS_COMPLETED:return"На сегодня ваша работа закончена.";case r.kb.VACANCY_STATUS_NO_APPEARANCE:return"Вы не явились на работу.";default:return"Сегодня вы назначены на вакансию."}}}}).actions(function(e){return{getCurrent:Object(a.flow)(m.a.mark(function t(){var n,r,c;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,e.errors=null,t.prev=2,t.next=5,Object(a.getEnv)(e).api.vacancies.getCurrent();case 5:n=t.sent,r=n.vacancy,e.vacancy=r,e.loading=!1,t.next=16;break;case 11:t.prev=11,t.t0=t.catch(2),c=Object(a.getEnv)(e).api.parseErrors(t.t0,{default:"Не удалось загрузить текущую вакансию"}),e.loading=!1,e.errors=c;case 16:case"end":return t.stop()}},t,null,[[2,11]])}))}});n.d(t,"d",function(){return i}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return p})},771:function(e,t,n){"use strict";var a,r,c,o,s=n(749),i=n(371),l=n(712),u=n(24),m=n.n(u),p=n(52),d=n.n(p),y=n(10),f=n.n(y),h=n(12),v=n.n(h),g=n(13),E=n.n(g),b=n(14),k=n.n(b),C=n(9),w=n.n(C),x=n(15),I=n.n(x),N=n(3),O=n.n(N),S=n(0),j=n(20),D=n(35),T=n(113),R=n(731),A=n(736),B=n(176),M=n(732),F=n(59),V=n(17),q=n.n(V),z=q()(function(e){return{card:{width:"calc(100% - ".concat(e.spacing(2),"px)"),margin:e.spacing(1)}}})(a=Object(j.c)(a=function(e){function t(){return f()(this,t),E()(this,k()(t).apply(this,arguments))}return I()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.vacancies,n=e.classes,a=e.onRespond;return t.map(function(e){return S.createElement(T.s,{key:e.id,loading:e.respondForm&&e.respondForm.sending},S.createElement(R.a,{className:n.card},S.createElement(M.a,null,S.createElement(F.a,{variant:"subtitle1"},e.role.name),S.createElement(F.a,{variant:"subtitle2"},e.shop.address),e.spot&&S.createElement(F.a,{variant:"subtitle2"},e.spot.name),S.createElement(F.a,{variant:"subtitle2"},e.plan.asText)),S.createElement(A.a,null,S.createElement(B.a,{size:"small",color:"primary",onClick:function(){return a(e)}},"Откликнуться"))))})}}]),t}(S.Component))||a)||a,W=n(724),_=n(726),P=n(725),L=n(723),U=n(722),Y=q()(function(){return{spot:{wordBreak:"break-word"},actions:{minWidth:150,padding:0,paddingRight:16}}})(r=Object(j.c)(r=function(e){function t(){return f()(this,t),E()(this,k()(t).apply(this,arguments))}return I()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.vacancies,n=e.classes,a=e.onRespond;return S.createElement(W.a,null,S.createElement(P.a,null,S.createElement(L.a,null,S.createElement(U.a,null,"ID"),S.createElement(U.a,null,"Статус"),S.createElement(U.a,null,"Дата"),S.createElement(U.a,null,"Время"),S.createElement(U.a,null,"Роль"),S.createElement(U.a,null,"Пост"),S.createElement(U.a,null,"Действия"))),S.createElement(_.a,null,t.map(function(e){return S.createElement(L.a,{key:e.id},S.createElement(U.a,null,e.id),S.createElement(U.a,null,e.statusAsText),S.createElement(U.a,null,e.dateAsText),S.createElement(U.a,null,S.createElement(F.a,null,"Запланировано: ".concat(e.plan.asText)),e.fact.notEmpty&&S.createElement(F.a,null,"Фактическое: ".concat(e.fact.asText))),S.createElement(U.a,null,e.role.name),S.createElement(U.a,{className:n.spot},e.spot?e.spot.name:"-"),S.createElement(U.a,{className:n.actions,align:"center"},S.createElement(T.s,{loading:e.respondForm.sending},S.createElement(B.a,{size:"small",color:"primary",onClick:function(){return a(e)}},"Откликнуться"))))})))}}]),t}(S.Component))||r)||r,J=n(766),H=Object(D.c)(J.c,{name:"shops"})(c=Object(D.c)(J.d,{name:"vacancies"})(c=Object(j.c)(c=function(e){function t(){var e,n;f()(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return n=E()(this,(e=k()(t)).call.apply(e,[this].concat(r))),O()(w()(n),"getShops",function(){var e=d()(m.a.mark(function e(t){var a,r,c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.shops,c=a.vacancies,r.setDate(t),e.next=4,r.getItems();case 4:r.items.length>0&&c.setDateAndShopId(t,r.items[0].id);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),O()(w()(n),"onChangeShopId",function(e){n.props.vacancies.setShopId(e.target.value)}),O()(w()(n),"onRespondClick",function(){var e=d()(m.a.mark(function e(t){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.respondForm.request();case 2:e.sent&&n.props.onRespondSuccess();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n}return I()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.getShops(this.props.date)}},{key:"render",value:function(){var e=this.props,t=e.shops,n=e.vacancies,a={vacancies:n.items,onRespond:this.onRespondClick};return S.createElement(T.s,{loading:t.loading},S.createElement(i.a,{select:!0,value:n.shopId||"",onChange:this.onChangeShopId,fullWidth:!0,margin:"normal",variant:"outlined",label:"Магазин"},t.items.map(function(e){return S.createElement(l.a,{key:e.id,value:e.id},e.name)})),S.createElement(T.s,{loading:n.loading},S.createElement(s.a,{mdDown:!0},S.createElement(Y,a)),S.createElement(s.a,{lgUp:!0},S.createElement(z,a))))}}]),t}(S.Component))||c)||c)||c,Z=n(705),G=n(737),K=n(152),Q=q()(function(e){var t;return{container:{padding:e.spacing(2),marginTop:40,position:"relative",display:"flex",flexDirection:"column"},header:(t={padding:e.spacing(2),marginTop:-40,marginBottom:e.spacing(1),backgroundColor:e.palette.primary.main,alignItems:"center"},O()(t,e.breakpoints.down("sm"),{flexWrap:"wrap"}),O()(t,"zIndex",11),t),headerText:{color:"white",marginRight:e.spacing(1)},cardContainer:{marginBottom:e.spacing(2),marginLeft:e.spacing(.5),marginRight:e.spacing(.5)}}})(o=Object(D.c)(J.a,{name:"model"})(o=Object(j.c)(o=function(e){function t(){return f()(this,t),E()(this,k()(t).apply(this,arguments))}return I()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.props.model.getCurrent()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.model;return S.createElement(K.a,{className:t.container},S.createElement(K.a,{className:t.header},S.createElement(F.a,{className:t.headerText,variant:"subtitle1"},n.titleText)),S.createElement(T.s,{noWrap:!0,loading:n.loading},n.vacancy&&S.createElement(Z.a,{container:!0},S.createElement(Z.a,{item:!0,xs:12,md:12,sm:12,lg:12},S.createElement(R.a,{className:t.cardContainer},S.createElement(G.a,{titleTypographyProps:{variant:"subtitle1"},title:n.titleText}),S.createElement(M.a,null,S.createElement(F.a,null,n.vacancy.shop.address),S.createElement(F.a,null,n.vacancy.role.name),S.createElement(F.a,null,n.vacancy.dateAsText," ",n.vacancy.plan.asText)))))))}}]),t}(S.Component))||o)||o)||o;n.d(t,"b",function(){return H}),n.d(t,"a",function(){return Q})}}]);